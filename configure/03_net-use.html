<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DOS Programs and NET USE &mdash; DOS WARES Configure 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/aaltsys.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="DOS WARES Configure 1.0 documentation" href="index.html" />
    <link rel="next" title="DOS Programs and EMS" href="04_dos-ems.html" />
    <link rel="prev" title="Move WARES to AAltSys Server" href="02_setup-wares.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="04_dos-ems.html" title="DOS Programs and EMS"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="02_setup-wares.html" title="Move WARES to AAltSys Server"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">DOS WARES Configure 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">DOS Programs and NET USE</a><ul>
<li><a class="reference internal" href="#download-links">Download links</a></li>
<li><a class="reference internal" href="#configure-32-bit-windows">Configure 32-bit Windows</a><ul>
<li><a class="reference internal" href="#setup-a-netprint-bat-icon">Setup a NETPRINT.BAT icon:</a></li>
<li><a class="reference internal" href="#setup-a-netshare-bat-icon">Setup a NETSHARE.BAT icon:</a></li>
<li><a class="reference internal" href="#wares-bat-for-windows-7">WARES.BAT for Windows 7:</a></li>
<li><a class="reference internal" href="#copy-wares-pif-to-desktop">Copy WARES.pif to Desktop:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bit-windows-virtual-mode">64-bit Windows Virtual Mode</a><ul>
<li><a class="reference internal" href="#installing-virtual-mode">Installing Virtual Mode</a></li>
<li><a class="reference internal" href="#copy-batch-programs-to-c">Copy Batch Programs to C:\</a></li>
<li><a class="reference internal" href="#call-batch-programs-on-c">Call Batch Programs on C:\</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="02_setup-wares.html"
                        title="previous chapter">Move WARES to AAltSys Server</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="04_dos-ems.html"
                        title="next chapter">DOS Programs and EMS</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/03_net-use.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="dos-programs-and-net-use">
<span id="netuse"></span><h1>DOS Programs and NET USE<a class="headerlink" href="#dos-programs-and-net-use" title="Permalink to this headline">¶</a></h1>
<p>DOS and some Windows applications rely on device mapping techniques to talk to
network fileshares and other services. A mapping associates a Windows host and
device name with a local virtual hardware device specification using
<strong class="command">NET USE</strong> commands.</p>
<p>While the <strong class="command">NET USE</strong> command includes a method of remembering mappings,
Windows has a corresponding habit of forgetting mappings at inopportune times.
Consequently script files should be created to execute mappings from desktop
icons.</p>
<p>The following instructions are intended to work in both Windows XP and
Windows 7. Testing was performed on Professional editions only.</p>
<div class="section" id="download-links">
<span id="downloads"></span><h2>Download links<a class="headerlink" href="#download-links" title="Permalink to this headline">¶</a></h2>
<p>Batch programs mentioned in this article may be downloaded from the following
links:</p>
<ul class="simple">
<li><a class="reference download internal" href="_downloads/netprint.bat"><tt class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">NETPRINT.BAT</span></tt></a>.</li>
<li><a class="reference download internal" href="_downloads/netshare.bat"><tt class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">NETSHARE.BAT</span></tt></a>.</li>
<li><a class="reference download internal" href="_downloads/wares.bat"><tt class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">WARES.BAT</span></tt></a>.</li>
<li><a class="reference download internal" href="_downloads/WARES.pif"><tt class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">WARES.pif</span></tt></a>.</li>
</ul>
</div>
<div class="section" id="configure-32-bit-windows">
<h2>Configure 32-bit Windows<a class="headerlink" href="#configure-32-bit-windows" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The configuration steps below will work for Windows XP and Windows 7
32-bit editions only. WARES cannot run natively on a 64-bit operating
system, and so the Windows virtual mode is required. In virtual mode, it is
not possible to call a desktop batch file with the <tt class="docutils literal"><span class="pre">%USERPROFILE%</span></tt> syntax
as described in section <a class="reference internal" href="#win7-waresbat"><em>WARES.BAT for Windows 7:</em></a>.</p>
</div>
<div class="section" id="setup-a-netprint-bat-icon">
<h3>Setup a NETPRINT.BAT icon:<a class="headerlink" href="#setup-a-netprint-bat-icon" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Right-Click on the desktop, choose <em class="menuselection">New ‣ Text document</em>.</p>
</li>
<li><p class="first">Change the filename to <cite>NETPRINT.BAT</cite> and press <tt class="kbd docutils literal"><span class="pre">&lt;Enter&gt;</span></tt>.</p>
</li>
<li><p class="first">Right-Click on <cite>NETPRINT.BAT</cite>, choose <em class="menuselection">Edit</em>.</p>
</li>
<li><p class="first">Enter printer mapping commands, for example:</p>
<div class="highlight-python"><pre>NET USE LPT1 /DELETE
NET USE LPT1 \\127.0.0.1\sharename
IF NOT %ERRORLEVEL%==0 PAUSE</pre>
</div>
</li>
<li><p class="first">Press <tt class="kbd docutils literal"><span class="pre">&lt;Alt-F&gt;,&lt;S&gt;,&lt;Alt-F&gt;,&lt;X&gt;</span></tt> to save and close.</p>
</li>
</ol>
</div>
<div class="section" id="setup-a-netshare-bat-icon">
<h3>Setup a NETSHARE.BAT icon:<a class="headerlink" href="#setup-a-netshare-bat-icon" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Right-Click on the desktop, choose <em class="menuselection">New ‣ Text document</em>.</p>
</li>
<li><p class="first">Change the filename to <tt class="file docutils literal"><span class="pre">NETSHARE.BAT</span></tt> and press <tt class="kbd docutils literal"><span class="pre">&lt;Enter&gt;</span></tt>.</p>
</li>
<li><p class="first">Right-Click on <tt class="file docutils literal"><span class="pre">NETSHARE.BAT</span></tt>, choose <em class="menuselection">Edit</em>.</p>
</li>
<li><p class="first">Enter share mapping commands, for example:</p>
<div class="highlight-python"><pre>NET USE W: /DELETE
NET USE W: \\AAltSysServer\wares
IF %ERRORLEVEL% NEQ 0 PAUSE
NET USE S: /DELETE
NET USE S: \\AAltSysServer\shared
IF %ERRORLEVEL% NEQ 0 PAUSE</pre>
</div>
</li>
<li><p class="first">Press <tt class="kbd docutils literal"><span class="pre">&lt;Alt-F&gt;,&lt;S&gt;,&lt;Alt-F&gt;,&lt;X&gt;</span></tt> to save and close.</p>
</li>
</ol>
</div>
<div class="section" id="wares-bat-for-windows-7">
<span id="win7-waresbat"></span><h3>WARES.BAT for Windows 7:<a class="headerlink" href="#wares-bat-for-windows-7" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Display a command window on the local windows workstation.</li>
<li>Type <tt class="kbd docutils literal"><span class="pre">EDIT</span> <span class="pre">W:\WARES.BAT</span></tt>, and press <tt class="kbd docutils literal"><span class="pre">&lt;Enter&gt;</span></tt>.</li>
<li>Press <tt class="kbd docutils literal"><span class="pre">&lt;Down&gt;,&lt;Enter&gt;,&lt;Up&gt;</span></tt> to insert a blank second line.</li>
<li>Type <tt class="kbd docutils literal"><span class="pre">CALL</span> <span class="pre">&quot;%USERPROFILE%\DESKTOP\NETPRINT.BAT&quot;</span></tt>.</li>
<li>Press <tt class="kbd docutils literal"><span class="pre">&lt;Alt-F&gt;,&lt;S&gt;,&lt;Alt-F&gt;,&lt;X&gt;</span></tt> to save and exit the editor.</li>
<li>Type <tt class="kbd docutils literal"><span class="pre">EXIT</span></tt> to close the command window.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Fixing <tt class="file docutils literal"><span class="pre">WARES.BAT</span></tt> is a global change. Perform this step
exactly once, not once per workstation.</p>
</div>
</div>
<div class="section" id="copy-wares-pif-to-desktop">
<h3>Copy WARES.pif to Desktop:<a class="headerlink" href="#copy-wares-pif-to-desktop" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Copy <tt class="file docutils literal"><span class="pre">W:\WARES.pif</span></tt> to the local desktop.</li>
<li>Right-click the icon, and choose <em class="menuselection">Properties</em>.</li>
<li>Click the <em class="guilabel">Program</em> tab.</li>
<li>At the <em class="guilabel">Cmd line:</em> prompt, specify a unique user identifier.
(This entry should read, <tt class="kbd docutils literal"><span class="pre">W:\WARES.BAT</span> <span class="pre">USERxx</span></tt> where <tt class="docutils literal"><span class="pre">xx</span></tt> is
between 00 and 09.)</li>
<li>Click buttons <em class="guilabel">Apply</em> and <em class="guilabel">OK</em>.</li>
</ol>
</div>
</div>
<div class="section" id="bit-windows-virtual-mode">
<h2>64-bit Windows Virtual Mode<a class="headerlink" href="#bit-windows-virtual-mode" title="Permalink to this headline">¶</a></h2>
<p>Programs running in Windows Virtual Mode cannot access the local user&#8217;s home
folder through the <tt class="docutils literal"><span class="pre">%USERPROFILE%</span></tt> command syntax. Also, Windows has a nasty
habit of refusing to execute batch commands which exist in the user&#8217;s home
folder when the active directory of the command is on another device. These
issues can be addressed through the following two-part workarounds, which can
be applied to all versions of Windows.</p>
<div class="section" id="installing-virtual-mode">
<h3>Installing Virtual Mode<a class="headerlink" href="#installing-virtual-mode" title="Permalink to this headline">¶</a></h3>
<p>Use <a class="reference external" href="http://windows.microsoft.com/en-US/windows7/install-and-use-windows-xp-mode-in-windows-7#section_3">Microsoft&#8217;s guide to installing Windows Virtual PC and XP Mode</a>
to set up your Windows 7 Professional, Enterprise, or Ultimate edition with
this free download feature.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Display the actual installation directions by clicking the blue
<em class="guilabel">Show all</em> title text.</p>
</div>
</div>
<div class="section" id="copy-batch-programs-to-c">
<h3>Copy Batch Programs to C:\<a class="headerlink" href="#copy-batch-programs-to-c" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open <em class="menuselection">Start ‣ (My) Computer</em> on the desktop.</li>
<li>Click on <tt class="file docutils literal"><span class="pre">Local</span> <span class="pre">Disk</span> <span class="pre">(C:\)</span></tt> to display the files and folders there.</li>
<li>Make sure the <em class="guilabel">Address</em> bar shows <tt class="file docutils literal"><span class="pre">C:\</span></tt>.</li>
<li>Drag <tt class="file docutils literal"><span class="pre">NETSHARE.BAT</span></tt> and <tt class="file docutils literal"><span class="pre">NETPRINT.BAT</span></tt> from the desktop to
an empty area of drive <tt class="file docutils literal"><span class="pre">C:\</span></tt>.</li>
<li>&lt;Right-click&gt; on <tt class="file docutils literal"><span class="pre">NETSHARE.BAT</span></tt>, choose <em class="menuselection">Create Shortcut</em>
from the menu.</li>
<li>&lt;Right-click&gt; on <tt class="file docutils literal"><span class="pre">NETPRINT.BAT</span></tt>, choose <em class="menuselection">Create Shortcut</em>
from the menu.</li>
<li>Drag the two new shortcut files from <tt class="file docutils literal"><span class="pre">C:\</span></tt> back to the desktop.</li>
<li>Close the <em class="guilabel">Computer</em> window.</li>
<li>On the desktop, &lt;Right-click&gt; <tt class="file docutils literal"><span class="pre">Shortcut</span> <span class="pre">to</span> <span class="pre">NETSHARE.BAT</span></tt> and choose
menu item <em class="menuselection">Rename</em>. Change the name to <tt class="file docutils literal"><span class="pre">NETSHARE.BAT</span></tt>.</li>
<li>On the desktop, &lt;Right-click&gt; <tt class="file docutils literal"><span class="pre">Shortcut</span> <span class="pre">to</span> <span class="pre">NETPRINT.BAT</span></tt> and choose
menu item <em class="menuselection">Rename</em>. Change the name to <tt class="file docutils literal"><span class="pre">NETPRINT.BAT</span></tt>.</li>
</ol>
</div>
<div class="section" id="call-batch-programs-on-c">
<h3>Call Batch Programs on C:\<a class="headerlink" href="#call-batch-programs-on-c" title="Permalink to this headline">¶</a></h3>
<p>Windows may refuse to execute <tt class="file docutils literal"><span class="pre">%USERPROFILE%\DESKTOP\NETPRINT.BAT</span></tt>,
particularly if the program is called from Virtual Mode. In that case, relocate
the program to drive <tt class="file docutils literal"><span class="pre">C:\</span></tt> as described previously. Then call it from
there, as follows:</p>
<ol class="arabic">
<li><p class="first">Display a command window on the local windows workstation.</p>
</li>
<li><p class="first">Type <tt class="kbd docutils literal"><span class="pre">EDIT</span> <span class="pre">W:\WARES.BAT</span></tt>, and press <tt class="kbd docutils literal"><span class="pre">&lt;Enter&gt;</span></tt>.</p>
</li>
<li><p class="first">Press <tt class="kbd docutils literal"><span class="pre">&lt;Down&gt;,&lt;Enter&gt;,&lt;Up&gt;</span></tt> to insert a blank second line.</p>
</li>
<li><p class="first">Type in the following series of commands:</p>
<div class="highlight-python"><pre>IF NOT EXIST "%USERPROFILE%\DESKTOP\NETPRINT.BAT" GOTO DRIVE_C
CALL "%USERPROFILE%\DESKTOP\NETPRINT.BAT"
GOTO ENDPRINT
:DRIVE_C
IF NOT EXIST %SYSTEMDRIVE%\NETPRINT.BAT GOTO ENDPRINT
%SYSTEMDRIVE%
CALL \NETPRINT.BAT
IF $%2$==$$ W:
%2
:ENDPRINT</pre>
</div>
</li>
<li><p class="first">Press <tt class="kbd docutils literal"><span class="pre">&lt;Alt-F&gt;,&lt;S&gt;,&lt;Alt-F&gt;,&lt;X&gt;</span></tt> to save and exit the editor.</p>
</li>
<li><p class="first">Type <tt class="kbd docutils literal"><span class="pre">EXIT</span></tt> to close the command window.</p>
</li>
</ol>
<p>This revised <a class="reference download internal" href="_downloads/wares.bat"><tt class="xref download docutils literal"><span class="pre">WARES.BAT</span></tt></a> may be
downloaded as mentioned above. The revised WARES.BAT and WARES.pif files
downloaded here are also intended to work with EMSmagic to provide EMS for Dell
and other computers with designed-in incompatibility.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="04_dos-ems.html" title="DOS Programs and EMS"
             >next</a></li>
        <li class="right" >
          <a href="02_setup-wares.html" title="Move WARES to AAltSys Server"
             >previous</a> |</li>
        <li><a href="index.html">DOS WARES Configure 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Gerald Lovel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>