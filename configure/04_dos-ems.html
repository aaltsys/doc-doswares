<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>EMS Memory Under MS Windows &mdash; DOS WARES Configure 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/aaltsys.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="DOS WARES Configure 1.0 documentation" href="index.html" />
    <link rel="next" title="Customer Access" href="06_cu-mfs.html" />
    <link rel="prev" title="DOS Programs and NET USE" href="03_net-use.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="06_cu-mfs.html" title="Customer Access"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="03_net-use.html" title="DOS Programs and NET USE"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">DOS WARES Configure 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">EMS Memory Under MS Windows</a><ul>
<li><a class="reference internal" href="#operating-system-ems-problems">Operating System EMS Problems</a><ul>
<li><a class="reference internal" href="#kb2724197-and-ems">KB2724197 and EMS</a></li>
<li><a class="reference internal" href="#using-lnk-instead-of-pif">Using .lnk instead of .pif</a></li>
<li><a class="reference internal" href="#ems-turned-off-in-pif">EMS turned off in .pif</a></li>
<li><a class="reference internal" href="#ems-blocked-by-virus-scan">EMS blocked by virus scan</a></li>
<li><a class="reference internal" href="#windows-vista">Windows Vista</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hardware-drivers-and-ems">Hardware Drivers and EMS</a><ul>
<li><a class="reference internal" href="#bios-settings">BIOS Settings</a></li>
<li><a class="reference internal" href="#systemboard-circuitry">Systemboard circuitry</a></li>
<li><a class="reference internal" href="#config-nt">CONFIG.NT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#replacing-microsoft-ems">Replacing Microsoft EMS</a><ul>
<li><a class="reference internal" href="#wares-bat">WARES.BAT</a></li>
<li><a class="reference internal" href="#wares-pif">WARES.pif</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-references">Other References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="03_net-use.html"
                        title="previous chapter">DOS Programs and NET USE</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="06_cu-mfs.html"
                        title="next chapter">Customer Access</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/04_dos-ems.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ems-memory-under-ms-windows">
<span id="dosems"></span><h1>EMS Memory Under MS Windows<a class="headerlink" href="#ems-memory-under-ms-windows" title="Permalink to this headline">¶</a></h1>
<p>Some DOS programs, including WARES, use an EMS (Expanded Memory System) driver
to access paged memory. Generally, EMS works on most computers until something
disables it. This article is all about disabling somethings.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The WARES for DOS program has a built-in test for working EMS. Menu
selection <em class="menuselection">Access ‣ Tourguide</em> will display either a list
of tours or a message to reconfigure CONFIG.SYS. Reconfiguration does not
work in Windows XP, so do not answer <code class="kbd docutils literal"><span class="pre">Yes</span></code> to this message, but the
test for EMS functioning is reliable. Otherwise, Microsoft&#8217;s OS does not in
any way indicate when EMS is disabled.</p>
</div>
<div class="section" id="operating-system-ems-problems">
<h2>Operating System EMS Problems<a class="headerlink" href="#operating-system-ems-problems" title="Permalink to this headline">¶</a></h2>
<p>Problems in the Windows operating system or associated software cause most EMS
issues. This section itemizes the common causes of these problems.</p>
<div class="section" id="kb2724197-and-ems">
<h3>KB2724197 and EMS<a class="headerlink" href="#kb2724197-and-ems" title="Permalink to this headline">¶</a></h3>
<p>Microsoft security patch KB2724197 for Windows XP from 10/9/2012 is intended to
prevent improper memory assignment in programs run by an authenticated local
user (meaning you, of course). Generally this patch should be removed or else
the <strong class="program">EMS Magic</strong> program described below must be used to provide EMS.
Follow the directions below to remove KB2724197 from Windows XP:</p>
<ol class="arabic">
<li><p class="first">From the <em class="guilabel">Start</em> menu, &lt;right-click&gt; <em class="guilabel">My Computer</em> and
choose <em class="menuselection">Properties</em>.</p>
</li>
<li><p class="first">In the <em class="guilabel">System Properties</em> window, display tab
<em class="guilabel">Automatic Updates</em>.</p>
</li>
<li><p class="first">Change settings from <em class="guilabel">Automatic</em> to
<em class="guilabel">Download Updates for me ... `, then click buttons
:guilabel:`Apply</em> and <em class="guilabel">OK</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Computers which are on an Active Directory domain cannot change
this setting. If the <em class="guilabel">Automatic</em> selection is grayed out,
contact your network administrator for assistance with this procedure.</p>
</div>
</li>
<li><p class="first">From the <em class="guilabel">Start</em> menu, open <em class="guilabel">Control Panel</em>, then open
<em class="guilabel">Add or Remove Programs</em>.</p>
</li>
<li><p class="first">Click the <em class="guilabel">Show Updates</em> checkbox and wait for the list to update.</p>
</li>
<li><p class="first">Scroll to the bottom of the list, maybe just above
<cite>Windows XP Service Pack 3</cite>.</p>
</li>
<li><p class="first">Click on item <em class="guilabel">Security Update KB2724197</em> from 10/10/12, which
will expand the entry.</p>
</li>
<li><p class="first">In the detailed display, click the <em class="guilabel">Remove</em> button, then click
<em class="guilabel">Next</em> to perform the remove operation.</p>
</li>
<li><p class="first">When the selection is removed, click <em class="guilabel">Finish</em> to complete and
restart Windows.</p>
</li>
</ol>
<p>DOS programs such as WARES will work correctly when this security update is
removed, but new Windows security updates will not be installed. Follow this
next set of directions to re-enable automatic updates:</p>
<ol class="arabic simple">
<li>Open menu selection <em class="menuselection">Start ‣ Microsoft Update</em> or
<em class="menuselection">Start ‣ Windows Update</em>.</li>
<li>Click the <em class="guilabel">Custom</em> button.</li>
<li>On the list of <em class="guilabel">High Priority Updates</em>, find
<em class="guilabel">Security Update for Windows XP (KB2724197)</em>.</li>
<li>Uncheck the checkbox next to <em class="guilabel">KB2724197</em>.</li>
<li>Click the <em class="guilabel">plus</em> sign to expand the item display, and check the
box <em class="guilabel">Don&#8217;t show this update again</em>.</li>
<li>Click <em class="menuselection">Install Updates</em> on the left menu to install other
updates, But choose to <em class="guilabel">Restart Later</em>.</li>
<li>Close <em class="guilabel">Microsoft Update</em>.</li>
<li>From the <em class="guilabel">Start</em> menu, &lt;right-click&gt; <em class="guilabel">My Computer</em> and
choose <em class="menuselection">Properties</em>.</li>
<li>In the <em class="guilabel">System Properties</em> window, display tab
<em class="guilabel">Automatic Updates</em>.</li>
<li>Change settings from <em class="guilabel">Download Updates for me ...</em> to
<em class="guilabel">Automatic</em>, then click buttons <em class="guilabel">Apply</em>, and
<em class="guilabel">OK</em>.</li>
<li>If other updates were installed, restart Windows.</li>
</ol>
</div>
<div class="section" id="using-lnk-instead-of-pif">
<h3>Using .lnk instead of .pif<a class="headerlink" href="#using-lnk-instead-of-pif" title="Permalink to this headline">¶</a></h3>
<p>By default, Windows does not load EMS drivers in DOS sessions. Instead, DOS
programs must be started from a <code class="file docutils literal"><span class="pre">.pif</span></code> file for EMS to be enabled.
Sometimes this start file gets lost, or is replaced with a link or batch file.
Windows XP supports using <code class="file docutils literal"><span class="pre">.pif</span></code> files, but it lacks a way to create
these files to start with.</p>
<p>Download <a class="reference external" href="_downloads/WARES.pif">this WARES.pif file</a> and modify it as
required if your <code class="file docutils literal"><span class="pre">.pif</span></code> is missing.</p>
<p>But how do you know if you are missing your <code class="file docutils literal"><span class="pre">.pif</span></code>? Good question, since
Windows never shows the <code class="file docutils literal"><span class="pre">.pif</span></code> file extension. &lt;Right-click&gt; your start
file and choose <em class="guilabel">Properties</em>. If the Properties window has eight
folder tabs, and one of them is <em class="guilabel">Memory</em>, then you have a
<code class="file docutils literal"><span class="pre">.pif</span></code> file.</p>
</div>
<div class="section" id="ems-turned-off-in-pif">
<h3>EMS turned off in .pif<a class="headerlink" href="#ems-turned-off-in-pif" title="Permalink to this headline">¶</a></h3>
<p>&lt;Right-click&gt; your <code class="file docutils literal"><span class="pre">.pif</span></code> start file, choose <em class="guilabel">Properties</em>, and
display the <em class="guilabel">Memory</em> tab. If the <em class="guilabel">Expanded (EMS) Memory</em>
total is set to <em class="guilabel">None</em>, change it to <em class="guilabel">Auto</em>.</p>
</div>
<div class="section" id="ems-blocked-by-virus-scan">
<h3>EMS blocked by virus scan<a class="headerlink" href="#ems-blocked-by-virus-scan" title="Permalink to this headline">¶</a></h3>
<p>Some virus scanning programs (Norton? McAfee?) may have settings which prevent
the EMS driver from loading. I cannot offer any advice about this issue.</p>
</div>
<div class="section" id="windows-vista">
<h3>Windows Vista<a class="headerlink" href="#windows-vista" title="Permalink to this headline">¶</a></h3>
<p>Microsoft removed support for EMS in Vista, but Windows 7 added EMS support
back. If you are using Vista, get a better operating system, or else use
<strong class="program">EMS Magic</strong>, described below.</p>
</div>
</div>
<div class="section" id="hardware-drivers-and-ems">
<h2>Hardware Drivers and EMS<a class="headerlink" href="#hardware-drivers-and-ems" title="Permalink to this headline">¶</a></h2>
<p>For new computers which cannot access EMS, the problem may be in hardware
settings which can be changed in BIOS.</p>
<p>BIOS, or firmware code, initializes the computer hardware before the operating
system loads. BIOS hardware drivers are mapped into a reserved area of computer
memory, called upper memory, between 640k and 1.0 MB. Microsoft&#8217;s EMS driver
requires a 64K page frame inside this same memory range. Where EMS is disabled
due to hardware problems, sometimes system components can be disabled or
replaced, freeing upper memory for EMS.</p>
<div class="section" id="bios-settings">
<h3>BIOS Settings<a class="headerlink" href="#bios-settings" title="Permalink to this headline">¶</a></h3>
<p>BIOS settings to enable optional hardware component support should be disabled.
Some of these items might be:</p>
<ul class="simple">
<li>Legacy USB support</li>
<li>Boot from Network</li>
<li>On-board Video BIOS Driver</li>
</ul>
</div>
<div class="section" id="systemboard-circuitry">
<h3>Systemboard circuitry<a class="headerlink" href="#systemboard-circuitry" title="Permalink to this headline">¶</a></h3>
<p>Some system board components may be disabled in the BIOS and replaced with
add-in component boards. Possible targets for this approach are:</p>
<ul class="simple">
<li>Disable on-board network port (NIC), add in a network card or USB port</li>
<li>Disable on-board video, add in a video card</li>
</ul>
</div>
<div class="section" id="config-nt">
<h3>CONFIG.NT<a class="headerlink" href="#config-nt" title="Permalink to this headline">¶</a></h3>
<p>On Windows XP, the system directory <code class="file docutils literal"><span class="pre">C:\Windows\System32</span></code> should contain
files <code class="file docutils literal"><span class="pre">CONFIG.NT</span></code> and <code class="file docutils literal"><span class="pre">AUTOEXEC.NT</span></code>. On some computers, EMS is
specifically prohibited by settings in these files. Edit file
<code class="file docutils literal"><span class="pre">C:\Windows\System32\CONFIG.NT</span></code>, and delete any lines which start with
<code class="docutils literal"><span class="pre">FILES</span></code> or <code class="docutils literal"><span class="pre">EMM</span></code>. Then add the following two lines at the bottom of the
file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">FILES</span><span class="o">=</span><span class="mi">100</span>
<span class="n">EMM</span><span class="o">=</span><span class="n">RAM</span>
</pre></div>
</div>
<p>This could possibly get EMS to work on a system, but as they say of diet pills,
&#8220;results may vary.&#8221; I have seen this work exactly once.</p>
</div>
</div>
<div class="section" id="replacing-microsoft-ems">
<span id="ems-magic"></span><h2>Replacing Microsoft EMS<a class="headerlink" href="#replacing-microsoft-ems" title="Permalink to this headline">¶</a></h2>
<p>Microsoft&#8217;s implementation of EMS in Windows uses the Upper Memory area. For
computers which are incompatible with this, an EMS replacement which emulates
EMS using XMS is available from <a class="reference external" href="http://www.emsmagic.com/">EMS Magic</a>.
EMS Magic claims to work on Vista, and also to work on computers which have
the notorious KB2724197 patch applied. Therefore this program can enable EMS
for DOS programs when nothing else works. EMS Magic is commercial software, and
it is well worth the U.S. $25.00 price if you need it.</p>
<p>After installing EMS Magic on a workstation, specific settings must be changed
in both the <code class="file docutils literal"><span class="pre">WARES.pif</span></code> program start file and the <code class="file docutils literal"><span class="pre">WARES.BAT</span></code>
execution control file. These changes are illustrated below:</p>
<div class="section" id="wares-bat">
<h3>WARES.BAT<a class="headerlink" href="#wares-bat" title="Permalink to this headline">¶</a></h3>
<p>The <code class="file docutils literal"><span class="pre">WARES.BAT</span></code> execution file is found in your <code class="file docutils literal"><span class="pre">ATLAS</span></code> folder. The
path to this file should be either: <code class="file docutils literal"><span class="pre">C:\ATLAS\WARES.BAT</span></code> on single-user
systems, or <code class="file docutils literal"><span class="pre">W:\WARES.BAT</span></code> on multiuser servers.</p>
<p>Change <code class="file docutils literal"><span class="pre">WARES.BAT</span></code> to call <strong class="program">EMSMAGIC</strong> as shown below:</p>
<div class="highlight-python"><div class="highlight"><pre>...

:MAIN
IF NOT &quot;%EMSMAGIC%&quot;==&quot;&quot; EMSMAGIC /RAM=4096
IF $%1$==$$ GOTO UNAME
IF EXIST %1.INI SET AREV=%1.INI
IF NOT EXIST %1.INI SET AREV=DEFAULT.INI
...
</pre></div>
</div>
<p>Make this setting change once for all users sharing a WARES system, as the batch
file is global.</p>
</div>
<div class="section" id="wares-pif">
<h3>WARES.pif<a class="headerlink" href="#wares-pif" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">WARES.pif Properties Memory tab</p>
<img alt="_images/wares-pif.png" class="last" src="_images/wares-pif.png" />
</div>
<p>By default, Extended (XMS) Memory may be disabled in the <code class="file docutils literal"><span class="pre">WARES.pif</span></code> file.
To enable XMS for EMSmagic at a particular workstation, &lt;Right-Click&gt; the
desktop <code class="file docutils literal"><span class="pre">WARES</span></code> icon and choose <em class="menuselection">Properties</em>. In the
Properties window, click on the <em class="guilabel">Memory</em> Tab. At the entry for
<em class="guilabel">Extended (XMS) memory</em>, set the total to the highest amount allowed,
as shown in the sidebar image. Then click buttons <em class="guilabel">Apply</em> and
<em class="guilabel">OK</em> to save your changes.</p>
<p>The <code class="file docutils literal"><span class="pre">WARES.pif</span></code> start icon must be updated at each workstation which has
EMS memory problems.</p>
</div>
</div>
<div class="section" id="other-references">
<h2>Other References<a class="headerlink" href="#other-references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.columbia.edu/~em36/wpdos/emsxp.html">This web page</a> supporting
WordPerfect for DOS is another source of information on EMS issues.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="06_cu-mfs.html" title="Customer Access"
             >next</a></li>
        <li class="right" >
          <a href="03_net-use.html" title="DOS Programs and NET USE"
             >previous</a> |</li>
        <li><a href="index.html">DOS WARES Configure 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Gerald Lovel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
    </div>
  </body>
</html>